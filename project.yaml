version: '3.0'

expectations:

  population_size: 100000

actions:

  ## #################################### 
  ## preliminaries 
  ## #################################### 

  design:
    run: r:latest analysis/design.R
    outputs:
      moderately_sensitive:
        study_dates_json: output/lib/study_parameters.json
        study_dates_rds: output/lib/study_parameters.rds
        jcvi_groups: output/lib/jcvi_groups.csv
        elig_dates: output/lib/elig_dates.csv
        regions: output/lib/regions.csv
        model_varlist: output/lib/model_varlist.rds
        outcomes: output/lib/outcomes.rds
        subgroups: output/lib/subgroups.rds

  ## #################################### 
  ## study definition 
  ## #################################### 
  ## generate dummy data for study_definition 

  dummy_data:
    run: r:latest analysis/dummy_data.R
    needs:
    - design
    outputs:
      moderately_sensitive:
        dummy_data: analysis/dummy_data.feather

  ## study definition 

  generate_study_population:
    run: cohortextractor:latest generate_cohort --study-definition study_definition
      --output-format feather
    dummy_data_file: analysis/dummy_data.feather
    needs:
    - design
    - dummy_data
    outputs:
      highly_sensitive:
        cohort: output/input.feather

  ## #################################### 
  ## preprocessing 
  ## #################################### 
  ## process data from study_definition 

  data_input_process:
    run: r:latest analysis/preprocess/data_input_process.R
    needs:
    - design
    - dummy_data
    - generate_study_population
    outputs:
      highly_sensitive:
        data_all: output/data/data_*.rds
      moderately_sensitive:
        data_properties: output/tables/data_*_tabulate.txt

  ## apply eligiblity criteria from boxes a and b 

  data_eligible_ab:
    run: r:latest analysis/preprocess/data_eligible_ab.R
    needs:
    - design
    - data_input_process
    outputs:
      highly_sensitive:
        data_eligible_a: output/data/data_eligible_a.rds
        data_eligible_b: output/data/data_eligible_b.rds
      moderately_sensitive:
        eligibility_count: output/lib/eligibility_count_ab.csv
        group_age_ranges: output/lib/group_age_ranges.csv

  ## #################################### 
  ## second_vax_period 
  ## #################################### 
  ## identify second vaccination time periods 
  ## create dataset for identifying second vaccination time periods 

  data_2nd_vax_dates:
    run: r:latest analysis/second_vax_period/data_2nd_vax_dates.R
    needs:
    - design
    - data_input_process
    - data_eligible_ab
    outputs:
      highly_sensitive:
        data_vax_plot: output/second_vax_period/data/data_vax_plot.rds
        second_vax_period_dates_rds: output/second_vax_period/data/second_vax_period_dates.rds
      moderately_sensitive:
        second_vax_period_dates_txt: output/second_vax_period/tables/second_vax_period_dates.txt

  ## plot second vaccination time periods 

  plot_2nd_vax_dates:
    run: r:latest analysis/second_vax_period/plot_2nd_vax_dates.R
    needs:
    - design
    - data_eligible_ab
    - data_2nd_vax_dates
    outputs:
      moderately_sensitive:
        plots_by_region: output/second_vax_period/images/plot_by_region_*.png

  ## apply eligiblity criteria from boxes c, d and e 

  data_eligible_cde:
    run: r:latest analysis/second_vax_period/data_eligible_cde.R
    needs:
    - design
    - data_input_process
    - data_eligible_ab
    - data_2nd_vax_dates
    outputs:
      highly_sensitive:
        data_eligible_e_vax: output/data/data_eligible_e_vax.rds
        data_eligible_e_unvax: output/data/data_eligible_e_unvax.rds

  ## #################################### 
  ## subsequent vaccination 
  ## #################################### 
  ## plot cumulative incidence of subsequent vaccination 

  plot_cumulative_incidence:
    run: r:latest analysis/subsequent_vax/plot_cumulative_incidence.R
    needs:
    - design
    - data_input_process
    - data_eligible_cde
    outputs:
      moderately_sensitive:
        ci_vax: output/subsequent_vax/images/ci_vax_*.png
        survtable: output/subsequent_vax/tables/survtable_*.txt

  ## #################################### 
  ## comparisons 
  ## #################################### 
  ## process comparisons data 

  data_comparisons_process:
    run: r:latest analysis/comparisons/data_comparisons_process.R
    needs:
    - design
    - data_input_process
    - data_2nd_vax_dates
    - data_eligible_cde
    outputs:
      highly_sensitive:
        data_comparisons: output/comparisons/data/data_comparisons_*.rds

  ## process tte data 

  data_tte_process_BNT162b2:
    run: r:latest analysis/comparisons/data_tte_process.R BNT162b2
    needs:
    - design
    - data_input_process
    - data_comparisons_process
    outputs:
      highly_sensitive:
        data_tte_brand_outcome: output/tte/data/data_tte_BNT162b2*.rds
        event_counts: output/tte/tables/event_counts_BNT162b2.rds

  data_tte_process_ChAdOx:
    run: r:latest analysis/comparisons/data_tte_process.R ChAdOx
    needs:
    - design
    - data_input_process
    - data_comparisons_process
    outputs:
      highly_sensitive:
        data_tte_brand_outcome: output/tte/data/data_tte_ChAdOx*.rds
        event_counts: output/tte/tables/event_counts_ChAdOx.rds

  data_tte_process_both:
    run: r:latest analysis/comparisons/data_tte_process.R both
    needs:
    - design
    - data_input_process
    - data_comparisons_process
    outputs:
      highly_sensitive:
        data_tte_brand_outcome: output/tte/data/data_tte_both*.rds
        event_counts: output/tte/tables/event_counts_both.rds

  ## process event counts tables 

  process_event_count_tables:
    run: r:latest analysis/comparisons/process_event_count_tables.R
    needs:
    - design
    - data_tte_process_BNT162b2
    - data_tte_process_ChAdOx
    outputs:
      moderately_sensitive:
        tidy_tables_events: output/tte/tables/tidy_events*.txt

  ## apply models 
  ## BNT162b2; 16-64 and clinically vulnerable; postest 
  ## preflight checks 

  preflight_BNT162b2_1_postest:
    run: r:latest analysis/comparisons/preflight.R BNT162b2 1 postest
    needs:
    - design
    - data_comparisons_process
    - data_tte_process_BNT162b2
    outputs:
      highly_sensitive:
        data_cox: output/models_cox/data/data_cox_BNT162b2_1_postest.rds
        model_instructions: output/lib/model_instructions_BNT162b2_1_postest.rds
      moderately_sensitive:
        eventcheck_table: output/models_cox/tables/eventcheck_BNT162b2_1_postest.html

  ## apply cox model 

  apply_model_cox_BNT162b2_1_postest:
    run: r:latest analysis/comparisons/apply_model_cox.R BNT162b2 1 postest
    needs:
    - design
    - preflight_BNT162b2_1_postest
    outputs:
      highly_sensitive:
        modelnumber: output/models_cox/data/model*_BNT162b2_1_postest.rds
        model_summary: output/models_cox/data/modelcox_summary_BNT162b2_1_postest.rds
        model_glance: output/models_cox/data/modelcox_glance_BNT162b2_1_postest.rds

  ## BNT162b2; 16-64 and clinically vulnerable; covidadmitted 
  ## preflight checks 

  preflight_BNT162b2_1_covidadmitted:
    run: r:latest analysis/comparisons/preflight.R BNT162b2 1 covidadmitted
    needs:
    - design
    - data_comparisons_process
    - data_tte_process_BNT162b2
    outputs:
      highly_sensitive:
        data_cox: output/models_cox/data/data_cox_BNT162b2_1_covidadmitted.rds
        model_instructions: output/lib/model_instructions_BNT162b2_1_covidadmitted.rds
      moderately_sensitive:
        eventcheck_table: output/models_cox/tables/eventcheck_BNT162b2_1_covidadmitted.html

  ## apply cox model 

  apply_model_cox_BNT162b2_1_covidadmitted:
    run: r:latest analysis/comparisons/apply_model_cox.R BNT162b2 1 covidadmitted
    needs:
    - design
    - preflight_BNT162b2_1_covidadmitted
    outputs:
      highly_sensitive:
        modelnumber: output/models_cox/data/model*_BNT162b2_1_covidadmitted.rds
        model_summary: output/models_cox/data/modelcox_summary_BNT162b2_1_covidadmitted.rds
        model_glance: output/models_cox/data/modelcox_glance_BNT162b2_1_covidadmitted.rds

  ## BNT162b2; 16-64 and clinically vulnerable; coviddeath 
  ## preflight checks 

  preflight_BNT162b2_1_coviddeath:
    run: r:latest analysis/comparisons/preflight.R BNT162b2 1 coviddeath
    needs:
    - design
    - data_comparisons_process
    - data_tte_process_BNT162b2
    outputs:
      highly_sensitive:
        data_cox: output/models_cox/data/data_cox_BNT162b2_1_coviddeath.rds
        model_instructions: output/lib/model_instructions_BNT162b2_1_coviddeath.rds
      moderately_sensitive:
        eventcheck_table: output/models_cox/tables/eventcheck_BNT162b2_1_coviddeath.html

  ## apply cox model 

  apply_model_cox_BNT162b2_1_coviddeath:
    run: r:latest analysis/comparisons/apply_model_cox.R BNT162b2 1 coviddeath
    needs:
    - design
    - preflight_BNT162b2_1_coviddeath
    outputs:
      highly_sensitive:
        modelnumber: output/models_cox/data/model*_BNT162b2_1_coviddeath.rds
        model_summary: output/models_cox/data/modelcox_summary_BNT162b2_1_coviddeath.rds
        model_glance: output/models_cox/data/modelcox_glance_BNT162b2_1_coviddeath.rds

  ## BNT162b2; 16-64 and clinically vulnerable; noncoviddeath 
  ## preflight checks 

  preflight_BNT162b2_1_noncoviddeath:
    run: r:latest analysis/comparisons/preflight.R BNT162b2 1 noncoviddeath
    needs:
    - design
    - data_comparisons_process
    - data_tte_process_BNT162b2
    outputs:
      highly_sensitive:
        data_cox: output/models_cox/data/data_cox_BNT162b2_1_noncoviddeath.rds
        model_instructions: output/lib/model_instructions_BNT162b2_1_noncoviddeath.rds
      moderately_sensitive:
        eventcheck_table: output/models_cox/tables/eventcheck_BNT162b2_1_noncoviddeath.html

  ## apply cox model 

  apply_model_cox_BNT162b2_1_noncoviddeath:
    run: r:latest analysis/comparisons/apply_model_cox.R BNT162b2 1 noncoviddeath
    needs:
    - design
    - preflight_BNT162b2_1_noncoviddeath
    outputs:
      highly_sensitive:
        modelnumber: output/models_cox/data/model*_BNT162b2_1_noncoviddeath.rds
        model_summary: output/models_cox/data/modelcox_summary_BNT162b2_1_noncoviddeath.rds
        model_glance: output/models_cox/data/modelcox_glance_BNT162b2_1_noncoviddeath.rds

  ## BNT162b2; 16-64 and clinically vulnerable; death 
  ## preflight checks 

  preflight_BNT162b2_1_death:
    run: r:latest analysis/comparisons/preflight.R BNT162b2 1 death
    needs:
    - design
    - data_comparisons_process
    - data_tte_process_BNT162b2
    outputs:
      highly_sensitive:
        data_cox: output/models_cox/data/data_cox_BNT162b2_1_death.rds
        model_instructions: output/lib/model_instructions_BNT162b2_1_death.rds
      moderately_sensitive:
        eventcheck_table: output/models_cox/tables/eventcheck_BNT162b2_1_death.html

  ## apply cox model 

  apply_model_cox_BNT162b2_1_death:
    run: r:latest analysis/comparisons/apply_model_cox.R BNT162b2 1 death
    needs:
    - design
    - preflight_BNT162b2_1_death
    outputs:
      highly_sensitive:
        modelnumber: output/models_cox/data/model*_BNT162b2_1_death.rds
        model_summary: output/models_cox/data/modelcox_summary_BNT162b2_1_death.rds
        model_glance: output/models_cox/data/modelcox_glance_BNT162b2_1_death.rds

  ## tabulate cox model for all outcomes 

  tables_model_cox_BNT162b2_1:
    run: r:latest analysis/comparisons/tables_cox.R BNT162b2 1
    needs:
    - design
    - data_2nd_vax_dates
    - data_tte_process_BNT162b2
    - apply_model_cox_BNT162b2_1_postest
    - apply_model_cox_BNT162b2_1_covidadmitted
    - apply_model_cox_BNT162b2_1_coviddeath
    - apply_model_cox_BNT162b2_1_noncoviddeath
    - apply_model_cox_BNT162b2_1_death
    outputs:
      moderately_sensitive:
        table_glance: output/models_cox/tables/modelcox_glance_BNT162b2_1.txt
        table_coefficients: output/models_cox/tables/modelcox_coefficients_BNT162b2_1.txt

  ## BNT162b2; 18-39; postest 
  ## preflight checks 

  preflight_BNT162b2_2_postest:
    run: r:latest analysis/comparisons/preflight.R BNT162b2 2 postest
    needs:
    - design
    - data_comparisons_process
    - data_tte_process_BNT162b2
    outputs:
      highly_sensitive:
        data_cox: output/models_cox/data/data_cox_BNT162b2_2_postest.rds
        model_instructions: output/lib/model_instructions_BNT162b2_2_postest.rds
      moderately_sensitive:
        eventcheck_table: output/models_cox/tables/eventcheck_BNT162b2_2_postest.html

  ## apply cox model 

  apply_model_cox_BNT162b2_2_postest:
    run: r:latest analysis/comparisons/apply_model_cox.R BNT162b2 2 postest
    needs:
    - design
    - preflight_BNT162b2_2_postest
    outputs:
      highly_sensitive:
        modelnumber: output/models_cox/data/model*_BNT162b2_2_postest.rds
        model_summary: output/models_cox/data/modelcox_summary_BNT162b2_2_postest.rds
        model_glance: output/models_cox/data/modelcox_glance_BNT162b2_2_postest.rds

  ## BNT162b2; 18-39; covidadmitted 
  ## preflight checks 

  preflight_BNT162b2_2_covidadmitted:
    run: r:latest analysis/comparisons/preflight.R BNT162b2 2 covidadmitted
    needs:
    - design
    - data_comparisons_process
    - data_tte_process_BNT162b2
    outputs:
      highly_sensitive:
        data_cox: output/models_cox/data/data_cox_BNT162b2_2_covidadmitted.rds
        model_instructions: output/lib/model_instructions_BNT162b2_2_covidadmitted.rds
      moderately_sensitive:
        eventcheck_table: output/models_cox/tables/eventcheck_BNT162b2_2_covidadmitted.html

  ## apply cox model 

  apply_model_cox_BNT162b2_2_covidadmitted:
    run: r:latest analysis/comparisons/apply_model_cox.R BNT162b2 2 covidadmitted
    needs:
    - design
    - preflight_BNT162b2_2_covidadmitted
    outputs:
      highly_sensitive:
        modelnumber: output/models_cox/data/model*_BNT162b2_2_covidadmitted.rds
        model_summary: output/models_cox/data/modelcox_summary_BNT162b2_2_covidadmitted.rds
        model_glance: output/models_cox/data/modelcox_glance_BNT162b2_2_covidadmitted.rds

  ## BNT162b2; 18-39; coviddeath 
  ## preflight checks 

  preflight_BNT162b2_2_coviddeath:
    run: r:latest analysis/comparisons/preflight.R BNT162b2 2 coviddeath
    needs:
    - design
    - data_comparisons_process
    - data_tte_process_BNT162b2
    outputs:
      highly_sensitive:
        data_cox: output/models_cox/data/data_cox_BNT162b2_2_coviddeath.rds
        model_instructions: output/lib/model_instructions_BNT162b2_2_coviddeath.rds
      moderately_sensitive:
        eventcheck_table: output/models_cox/tables/eventcheck_BNT162b2_2_coviddeath.html

  ## apply cox model 

  apply_model_cox_BNT162b2_2_coviddeath:
    run: r:latest analysis/comparisons/apply_model_cox.R BNT162b2 2 coviddeath
    needs:
    - design
    - preflight_BNT162b2_2_coviddeath
    outputs:
      highly_sensitive:
        modelnumber: output/models_cox/data/model*_BNT162b2_2_coviddeath.rds
        model_summary: output/models_cox/data/modelcox_summary_BNT162b2_2_coviddeath.rds
        model_glance: output/models_cox/data/modelcox_glance_BNT162b2_2_coviddeath.rds

  ## BNT162b2; 18-39; noncoviddeath 
  ## preflight checks 

  preflight_BNT162b2_2_noncoviddeath:
    run: r:latest analysis/comparisons/preflight.R BNT162b2 2 noncoviddeath
    needs:
    - design
    - data_comparisons_process
    - data_tte_process_BNT162b2
    outputs:
      highly_sensitive:
        data_cox: output/models_cox/data/data_cox_BNT162b2_2_noncoviddeath.rds
        model_instructions: output/lib/model_instructions_BNT162b2_2_noncoviddeath.rds
      moderately_sensitive:
        eventcheck_table: output/models_cox/tables/eventcheck_BNT162b2_2_noncoviddeath.html

  ## apply cox model 

  apply_model_cox_BNT162b2_2_noncoviddeath:
    run: r:latest analysis/comparisons/apply_model_cox.R BNT162b2 2 noncoviddeath
    needs:
    - design
    - preflight_BNT162b2_2_noncoviddeath
    outputs:
      highly_sensitive:
        modelnumber: output/models_cox/data/model*_BNT162b2_2_noncoviddeath.rds
        model_summary: output/models_cox/data/modelcox_summary_BNT162b2_2_noncoviddeath.rds
        model_glance: output/models_cox/data/modelcox_glance_BNT162b2_2_noncoviddeath.rds

  ## BNT162b2; 18-39; death 
  ## preflight checks 

  preflight_BNT162b2_2_death:
    run: r:latest analysis/comparisons/preflight.R BNT162b2 2 death
    needs:
    - design
    - data_comparisons_process
    - data_tte_process_BNT162b2
    outputs:
      highly_sensitive:
        data_cox: output/models_cox/data/data_cox_BNT162b2_2_death.rds
        model_instructions: output/lib/model_instructions_BNT162b2_2_death.rds
      moderately_sensitive:
        eventcheck_table: output/models_cox/tables/eventcheck_BNT162b2_2_death.html

  ## apply cox model 

  apply_model_cox_BNT162b2_2_death:
    run: r:latest analysis/comparisons/apply_model_cox.R BNT162b2 2 death
    needs:
    - design
    - preflight_BNT162b2_2_death
    outputs:
      highly_sensitive:
        modelnumber: output/models_cox/data/model*_BNT162b2_2_death.rds
        model_summary: output/models_cox/data/modelcox_summary_BNT162b2_2_death.rds
        model_glance: output/models_cox/data/modelcox_glance_BNT162b2_2_death.rds

  ## tabulate cox model for all outcomes 

  tables_model_cox_BNT162b2_2:
    run: r:latest analysis/comparisons/tables_cox.R BNT162b2 2
    needs:
    - design
    - data_2nd_vax_dates
    - data_tte_process_BNT162b2
    - apply_model_cox_BNT162b2_2_postest
    - apply_model_cox_BNT162b2_2_covidadmitted
    - apply_model_cox_BNT162b2_2_coviddeath
    - apply_model_cox_BNT162b2_2_noncoviddeath
    - apply_model_cox_BNT162b2_2_death
    outputs:
      moderately_sensitive:
        table_glance: output/models_cox/tables/modelcox_glance_BNT162b2_2.txt
        table_coefficients: output/models_cox/tables/modelcox_coefficients_BNT162b2_2.txt

  ## BNT162b2; 40-64; postest 
  ## preflight checks 

  preflight_BNT162b2_3_postest:
    run: r:latest analysis/comparisons/preflight.R BNT162b2 3 postest
    needs:
    - design
    - data_comparisons_process
    - data_tte_process_BNT162b2
    outputs:
      highly_sensitive:
        data_cox: output/models_cox/data/data_cox_BNT162b2_3_postest.rds
        model_instructions: output/lib/model_instructions_BNT162b2_3_postest.rds
      moderately_sensitive:
        eventcheck_table: output/models_cox/tables/eventcheck_BNT162b2_3_postest.html

  ## apply cox model 

  apply_model_cox_BNT162b2_3_postest:
    run: r:latest analysis/comparisons/apply_model_cox.R BNT162b2 3 postest
    needs:
    - design
    - preflight_BNT162b2_3_postest
    outputs:
      highly_sensitive:
        modelnumber: output/models_cox/data/model*_BNT162b2_3_postest.rds
        model_summary: output/models_cox/data/modelcox_summary_BNT162b2_3_postest.rds
        model_glance: output/models_cox/data/modelcox_glance_BNT162b2_3_postest.rds

  ## BNT162b2; 40-64; covidadmitted 
  ## preflight checks 

  preflight_BNT162b2_3_covidadmitted:
    run: r:latest analysis/comparisons/preflight.R BNT162b2 3 covidadmitted
    needs:
    - design
    - data_comparisons_process
    - data_tte_process_BNT162b2
    outputs:
      highly_sensitive:
        data_cox: output/models_cox/data/data_cox_BNT162b2_3_covidadmitted.rds
        model_instructions: output/lib/model_instructions_BNT162b2_3_covidadmitted.rds
      moderately_sensitive:
        eventcheck_table: output/models_cox/tables/eventcheck_BNT162b2_3_covidadmitted.html

  ## apply cox model 

  apply_model_cox_BNT162b2_3_covidadmitted:
    run: r:latest analysis/comparisons/apply_model_cox.R BNT162b2 3 covidadmitted
    needs:
    - design
    - preflight_BNT162b2_3_covidadmitted
    outputs:
      highly_sensitive:
        modelnumber: output/models_cox/data/model*_BNT162b2_3_covidadmitted.rds
        model_summary: output/models_cox/data/modelcox_summary_BNT162b2_3_covidadmitted.rds
        model_glance: output/models_cox/data/modelcox_glance_BNT162b2_3_covidadmitted.rds

  ## BNT162b2; 40-64; coviddeath 
  ## preflight checks 

  preflight_BNT162b2_3_coviddeath:
    run: r:latest analysis/comparisons/preflight.R BNT162b2 3 coviddeath
    needs:
    - design
    - data_comparisons_process
    - data_tte_process_BNT162b2
    outputs:
      highly_sensitive:
        data_cox: output/models_cox/data/data_cox_BNT162b2_3_coviddeath.rds
        model_instructions: output/lib/model_instructions_BNT162b2_3_coviddeath.rds
      moderately_sensitive:
        eventcheck_table: output/models_cox/tables/eventcheck_BNT162b2_3_coviddeath.html

  ## apply cox model 

  apply_model_cox_BNT162b2_3_coviddeath:
    run: r:latest analysis/comparisons/apply_model_cox.R BNT162b2 3 coviddeath
    needs:
    - design
    - preflight_BNT162b2_3_coviddeath
    outputs:
      highly_sensitive:
        modelnumber: output/models_cox/data/model*_BNT162b2_3_coviddeath.rds
        model_summary: output/models_cox/data/modelcox_summary_BNT162b2_3_coviddeath.rds
        model_glance: output/models_cox/data/modelcox_glance_BNT162b2_3_coviddeath.rds

  ## BNT162b2; 40-64; noncoviddeath 
  ## preflight checks 

  preflight_BNT162b2_3_noncoviddeath:
    run: r:latest analysis/comparisons/preflight.R BNT162b2 3 noncoviddeath
    needs:
    - design
    - data_comparisons_process
    - data_tte_process_BNT162b2
    outputs:
      highly_sensitive:
        data_cox: output/models_cox/data/data_cox_BNT162b2_3_noncoviddeath.rds
        model_instructions: output/lib/model_instructions_BNT162b2_3_noncoviddeath.rds
      moderately_sensitive:
        eventcheck_table: output/models_cox/tables/eventcheck_BNT162b2_3_noncoviddeath.html

  ## apply cox model 

  apply_model_cox_BNT162b2_3_noncoviddeath:
    run: r:latest analysis/comparisons/apply_model_cox.R BNT162b2 3 noncoviddeath
    needs:
    - design
    - preflight_BNT162b2_3_noncoviddeath
    outputs:
      highly_sensitive:
        modelnumber: output/models_cox/data/model*_BNT162b2_3_noncoviddeath.rds
        model_summary: output/models_cox/data/modelcox_summary_BNT162b2_3_noncoviddeath.rds
        model_glance: output/models_cox/data/modelcox_glance_BNT162b2_3_noncoviddeath.rds

  ## BNT162b2; 40-64; death 
  ## preflight checks 

  preflight_BNT162b2_3_death:
    run: r:latest analysis/comparisons/preflight.R BNT162b2 3 death
    needs:
    - design
    - data_comparisons_process
    - data_tte_process_BNT162b2
    outputs:
      highly_sensitive:
        data_cox: output/models_cox/data/data_cox_BNT162b2_3_death.rds
        model_instructions: output/lib/model_instructions_BNT162b2_3_death.rds
      moderately_sensitive:
        eventcheck_table: output/models_cox/tables/eventcheck_BNT162b2_3_death.html

  ## apply cox model 

  apply_model_cox_BNT162b2_3_death:
    run: r:latest analysis/comparisons/apply_model_cox.R BNT162b2 3 death
    needs:
    - design
    - preflight_BNT162b2_3_death
    outputs:
      highly_sensitive:
        modelnumber: output/models_cox/data/model*_BNT162b2_3_death.rds
        model_summary: output/models_cox/data/modelcox_summary_BNT162b2_3_death.rds
        model_glance: output/models_cox/data/modelcox_glance_BNT162b2_3_death.rds

  ## tabulate cox model for all outcomes 

  tables_model_cox_BNT162b2_3:
    run: r:latest analysis/comparisons/tables_cox.R BNT162b2 3
    needs:
    - design
    - data_2nd_vax_dates
    - data_tte_process_BNT162b2
    - apply_model_cox_BNT162b2_3_postest
    - apply_model_cox_BNT162b2_3_covidadmitted
    - apply_model_cox_BNT162b2_3_coviddeath
    - apply_model_cox_BNT162b2_3_noncoviddeath
    - apply_model_cox_BNT162b2_3_death
    outputs:
      moderately_sensitive:
        table_glance: output/models_cox/tables/modelcox_glance_BNT162b2_3.txt
        table_coefficients: output/models_cox/tables/modelcox_coefficients_BNT162b2_3.txt

  ## BNT162b2; 65+; postest 
  ## preflight checks 

  preflight_BNT162b2_4_postest:
    run: r:latest analysis/comparisons/preflight.R BNT162b2 4 postest
    needs:
    - design
    - data_comparisons_process
    - data_tte_process_BNT162b2
    outputs:
      highly_sensitive:
        data_cox: output/models_cox/data/data_cox_BNT162b2_4_postest.rds
        model_instructions: output/lib/model_instructions_BNT162b2_4_postest.rds
      moderately_sensitive:
        eventcheck_table: output/models_cox/tables/eventcheck_BNT162b2_4_postest.html

  ## apply cox model 

  apply_model_cox_BNT162b2_4_postest:
    run: r:latest analysis/comparisons/apply_model_cox.R BNT162b2 4 postest
    needs:
    - design
    - preflight_BNT162b2_4_postest
    outputs:
      highly_sensitive:
        modelnumber: output/models_cox/data/model*_BNT162b2_4_postest.rds
        model_summary: output/models_cox/data/modelcox_summary_BNT162b2_4_postest.rds
        model_glance: output/models_cox/data/modelcox_glance_BNT162b2_4_postest.rds

  ## BNT162b2; 65+; covidadmitted 
  ## preflight checks 

  preflight_BNT162b2_4_covidadmitted:
    run: r:latest analysis/comparisons/preflight.R BNT162b2 4 covidadmitted
    needs:
    - design
    - data_comparisons_process
    - data_tte_process_BNT162b2
    outputs:
      highly_sensitive:
        data_cox: output/models_cox/data/data_cox_BNT162b2_4_covidadmitted.rds
        model_instructions: output/lib/model_instructions_BNT162b2_4_covidadmitted.rds
      moderately_sensitive:
        eventcheck_table: output/models_cox/tables/eventcheck_BNT162b2_4_covidadmitted.html

  ## apply cox model 

  apply_model_cox_BNT162b2_4_covidadmitted:
    run: r:latest analysis/comparisons/apply_model_cox.R BNT162b2 4 covidadmitted
    needs:
    - design
    - preflight_BNT162b2_4_covidadmitted
    outputs:
      highly_sensitive:
        modelnumber: output/models_cox/data/model*_BNT162b2_4_covidadmitted.rds
        model_summary: output/models_cox/data/modelcox_summary_BNT162b2_4_covidadmitted.rds
        model_glance: output/models_cox/data/modelcox_glance_BNT162b2_4_covidadmitted.rds

  ## BNT162b2; 65+; coviddeath 
  ## preflight checks 

  preflight_BNT162b2_4_coviddeath:
    run: r:latest analysis/comparisons/preflight.R BNT162b2 4 coviddeath
    needs:
    - design
    - data_comparisons_process
    - data_tte_process_BNT162b2
    outputs:
      highly_sensitive:
        data_cox: output/models_cox/data/data_cox_BNT162b2_4_coviddeath.rds
        model_instructions: output/lib/model_instructions_BNT162b2_4_coviddeath.rds
      moderately_sensitive:
        eventcheck_table: output/models_cox/tables/eventcheck_BNT162b2_4_coviddeath.html

  ## apply cox model 

  apply_model_cox_BNT162b2_4_coviddeath:
    run: r:latest analysis/comparisons/apply_model_cox.R BNT162b2 4 coviddeath
    needs:
    - design
    - preflight_BNT162b2_4_coviddeath
    outputs:
      highly_sensitive:
        modelnumber: output/models_cox/data/model*_BNT162b2_4_coviddeath.rds
        model_summary: output/models_cox/data/modelcox_summary_BNT162b2_4_coviddeath.rds
        model_glance: output/models_cox/data/modelcox_glance_BNT162b2_4_coviddeath.rds

  ## BNT162b2; 65+; noncoviddeath 
  ## preflight checks 

  preflight_BNT162b2_4_noncoviddeath:
    run: r:latest analysis/comparisons/preflight.R BNT162b2 4 noncoviddeath
    needs:
    - design
    - data_comparisons_process
    - data_tte_process_BNT162b2
    outputs:
      highly_sensitive:
        data_cox: output/models_cox/data/data_cox_BNT162b2_4_noncoviddeath.rds
        model_instructions: output/lib/model_instructions_BNT162b2_4_noncoviddeath.rds
      moderately_sensitive:
        eventcheck_table: output/models_cox/tables/eventcheck_BNT162b2_4_noncoviddeath.html

  ## apply cox model 

  apply_model_cox_BNT162b2_4_noncoviddeath:
    run: r:latest analysis/comparisons/apply_model_cox.R BNT162b2 4 noncoviddeath
    needs:
    - design
    - preflight_BNT162b2_4_noncoviddeath
    outputs:
      highly_sensitive:
        modelnumber: output/models_cox/data/model*_BNT162b2_4_noncoviddeath.rds
        model_summary: output/models_cox/data/modelcox_summary_BNT162b2_4_noncoviddeath.rds
        model_glance: output/models_cox/data/modelcox_glance_BNT162b2_4_noncoviddeath.rds

  ## BNT162b2; 65+; death 
  ## preflight checks 

  preflight_BNT162b2_4_death:
    run: r:latest analysis/comparisons/preflight.R BNT162b2 4 death
    needs:
    - design
    - data_comparisons_process
    - data_tte_process_BNT162b2
    outputs:
      highly_sensitive:
        data_cox: output/models_cox/data/data_cox_BNT162b2_4_death.rds
        model_instructions: output/lib/model_instructions_BNT162b2_4_death.rds
      moderately_sensitive:
        eventcheck_table: output/models_cox/tables/eventcheck_BNT162b2_4_death.html

  ## apply cox model 

  apply_model_cox_BNT162b2_4_death:
    run: r:latest analysis/comparisons/apply_model_cox.R BNT162b2 4 death
    needs:
    - design
    - preflight_BNT162b2_4_death
    outputs:
      highly_sensitive:
        modelnumber: output/models_cox/data/model*_BNT162b2_4_death.rds
        model_summary: output/models_cox/data/modelcox_summary_BNT162b2_4_death.rds
        model_glance: output/models_cox/data/modelcox_glance_BNT162b2_4_death.rds

  ## tabulate cox model for all outcomes 

  tables_model_cox_BNT162b2_4:
    run: r:latest analysis/comparisons/tables_cox.R BNT162b2 4
    needs:
    - design
    - data_2nd_vax_dates
    - data_tte_process_BNT162b2
    - apply_model_cox_BNT162b2_4_postest
    - apply_model_cox_BNT162b2_4_covidadmitted
    - apply_model_cox_BNT162b2_4_coviddeath
    - apply_model_cox_BNT162b2_4_noncoviddeath
    - apply_model_cox_BNT162b2_4_death
    outputs:
      moderately_sensitive:
        table_glance: output/models_cox/tables/modelcox_glance_BNT162b2_4.txt
        table_coefficients: output/models_cox/tables/modelcox_coefficients_BNT162b2_4.txt

  ## BNT162b2; all; postest 
  ## preflight checks 

  preflight_BNT162b2_5_postest:
    run: r:latest analysis/comparisons/preflight.R BNT162b2 5 postest
    needs:
    - design
    - data_comparisons_process
    - data_tte_process_BNT162b2
    outputs:
      highly_sensitive:
        data_cox: output/models_cox/data/data_cox_BNT162b2_5_postest.rds
        model_instructions: output/lib/model_instructions_BNT162b2_5_postest.rds
      moderately_sensitive:
        eventcheck_table: output/models_cox/tables/eventcheck_BNT162b2_5_postest.html

  ## apply cox model 

  apply_model_cox_BNT162b2_5_postest:
    run: r:latest analysis/comparisons/apply_model_cox.R BNT162b2 5 postest
    needs:
    - design
    - preflight_BNT162b2_5_postest
    outputs:
      highly_sensitive:
        modelnumber: output/models_cox/data/model*_BNT162b2_5_postest.rds
        model_summary: output/models_cox/data/modelcox_summary_BNT162b2_5_postest.rds
        model_glance: output/models_cox/data/modelcox_glance_BNT162b2_5_postest.rds

  ## BNT162b2; all; covidadmitted 
  ## preflight checks 

  preflight_BNT162b2_5_covidadmitted:
    run: r:latest analysis/comparisons/preflight.R BNT162b2 5 covidadmitted
    needs:
    - design
    - data_comparisons_process
    - data_tte_process_BNT162b2
    outputs:
      highly_sensitive:
        data_cox: output/models_cox/data/data_cox_BNT162b2_5_covidadmitted.rds
        model_instructions: output/lib/model_instructions_BNT162b2_5_covidadmitted.rds
      moderately_sensitive:
        eventcheck_table: output/models_cox/tables/eventcheck_BNT162b2_5_covidadmitted.html

  ## apply cox model 

  apply_model_cox_BNT162b2_5_covidadmitted:
    run: r:latest analysis/comparisons/apply_model_cox.R BNT162b2 5 covidadmitted
    needs:
    - design
    - preflight_BNT162b2_5_covidadmitted
    outputs:
      highly_sensitive:
        modelnumber: output/models_cox/data/model*_BNT162b2_5_covidadmitted.rds
        model_summary: output/models_cox/data/modelcox_summary_BNT162b2_5_covidadmitted.rds
        model_glance: output/models_cox/data/modelcox_glance_BNT162b2_5_covidadmitted.rds

  ## BNT162b2; all; coviddeath 
  ## preflight checks 

  preflight_BNT162b2_5_coviddeath:
    run: r:latest analysis/comparisons/preflight.R BNT162b2 5 coviddeath
    needs:
    - design
    - data_comparisons_process
    - data_tte_process_BNT162b2
    outputs:
      highly_sensitive:
        data_cox: output/models_cox/data/data_cox_BNT162b2_5_coviddeath.rds
        model_instructions: output/lib/model_instructions_BNT162b2_5_coviddeath.rds
      moderately_sensitive:
        eventcheck_table: output/models_cox/tables/eventcheck_BNT162b2_5_coviddeath.html

  ## apply cox model 

  apply_model_cox_BNT162b2_5_coviddeath:
    run: r:latest analysis/comparisons/apply_model_cox.R BNT162b2 5 coviddeath
    needs:
    - design
    - preflight_BNT162b2_5_coviddeath
    outputs:
      highly_sensitive:
        modelnumber: output/models_cox/data/model*_BNT162b2_5_coviddeath.rds
        model_summary: output/models_cox/data/modelcox_summary_BNT162b2_5_coviddeath.rds
        model_glance: output/models_cox/data/modelcox_glance_BNT162b2_5_coviddeath.rds

  ## BNT162b2; all; noncoviddeath 
  ## preflight checks 

  preflight_BNT162b2_5_noncoviddeath:
    run: r:latest analysis/comparisons/preflight.R BNT162b2 5 noncoviddeath
    needs:
    - design
    - data_comparisons_process
    - data_tte_process_BNT162b2
    outputs:
      highly_sensitive:
        data_cox: output/models_cox/data/data_cox_BNT162b2_5_noncoviddeath.rds
        model_instructions: output/lib/model_instructions_BNT162b2_5_noncoviddeath.rds
      moderately_sensitive:
        eventcheck_table: output/models_cox/tables/eventcheck_BNT162b2_5_noncoviddeath.html

  ## apply cox model 

  apply_model_cox_BNT162b2_5_noncoviddeath:
    run: r:latest analysis/comparisons/apply_model_cox.R BNT162b2 5 noncoviddeath
    needs:
    - design
    - preflight_BNT162b2_5_noncoviddeath
    outputs:
      highly_sensitive:
        modelnumber: output/models_cox/data/model*_BNT162b2_5_noncoviddeath.rds
        model_summary: output/models_cox/data/modelcox_summary_BNT162b2_5_noncoviddeath.rds
        model_glance: output/models_cox/data/modelcox_glance_BNT162b2_5_noncoviddeath.rds

  ## BNT162b2; all; death 
  ## preflight checks 

  preflight_BNT162b2_5_death:
    run: r:latest analysis/comparisons/preflight.R BNT162b2 5 death
    needs:
    - design
    - data_comparisons_process
    - data_tte_process_BNT162b2
    outputs:
      highly_sensitive:
        data_cox: output/models_cox/data/data_cox_BNT162b2_5_death.rds
        model_instructions: output/lib/model_instructions_BNT162b2_5_death.rds
      moderately_sensitive:
        eventcheck_table: output/models_cox/tables/eventcheck_BNT162b2_5_death.html

  ## apply cox model 

  apply_model_cox_BNT162b2_5_death:
    run: r:latest analysis/comparisons/apply_model_cox.R BNT162b2 5 death
    needs:
    - design
    - preflight_BNT162b2_5_death
    outputs:
      highly_sensitive:
        modelnumber: output/models_cox/data/model*_BNT162b2_5_death.rds
        model_summary: output/models_cox/data/modelcox_summary_BNT162b2_5_death.rds
        model_glance: output/models_cox/data/modelcox_glance_BNT162b2_5_death.rds

  ## tabulate cox model for all outcomes 

  tables_model_cox_BNT162b2_5:
    run: r:latest analysis/comparisons/tables_cox.R BNT162b2 5
    needs:
    - design
    - data_2nd_vax_dates
    - data_tte_process_BNT162b2
    - apply_model_cox_BNT162b2_5_postest
    - apply_model_cox_BNT162b2_5_covidadmitted
    - apply_model_cox_BNT162b2_5_coviddeath
    - apply_model_cox_BNT162b2_5_noncoviddeath
    - apply_model_cox_BNT162b2_5_death
    outputs:
      moderately_sensitive:
        table_glance: output/models_cox/tables/modelcox_glance_BNT162b2_5.txt
        table_coefficients: output/models_cox/tables/modelcox_coefficients_BNT162b2_5.txt

  ## ChAdOx; 16-64 and clinically vulnerable; postest 
  ## preflight checks 

  preflight_ChAdOx_1_postest:
    run: r:latest analysis/comparisons/preflight.R ChAdOx 1 postest
    needs:
    - design
    - data_comparisons_process
    - data_tte_process_ChAdOx
    outputs:
      highly_sensitive:
        data_cox: output/models_cox/data/data_cox_ChAdOx_1_postest.rds
        model_instructions: output/lib/model_instructions_ChAdOx_1_postest.rds
      moderately_sensitive:
        eventcheck_table: output/models_cox/tables/eventcheck_ChAdOx_1_postest.html

  ## apply cox model 

  apply_model_cox_ChAdOx_1_postest:
    run: r:latest analysis/comparisons/apply_model_cox.R ChAdOx 1 postest
    needs:
    - design
    - preflight_ChAdOx_1_postest
    outputs:
      highly_sensitive:
        modelnumber: output/models_cox/data/model*_ChAdOx_1_postest.rds
        model_summary: output/models_cox/data/modelcox_summary_ChAdOx_1_postest.rds
        model_glance: output/models_cox/data/modelcox_glance_ChAdOx_1_postest.rds

  ## ChAdOx; 16-64 and clinically vulnerable; covidadmitted 
  ## preflight checks 

  preflight_ChAdOx_1_covidadmitted:
    run: r:latest analysis/comparisons/preflight.R ChAdOx 1 covidadmitted
    needs:
    - design
    - data_comparisons_process
    - data_tte_process_ChAdOx
    outputs:
      highly_sensitive:
        data_cox: output/models_cox/data/data_cox_ChAdOx_1_covidadmitted.rds
        model_instructions: output/lib/model_instructions_ChAdOx_1_covidadmitted.rds
      moderately_sensitive:
        eventcheck_table: output/models_cox/tables/eventcheck_ChAdOx_1_covidadmitted.html

  ## apply cox model 

  apply_model_cox_ChAdOx_1_covidadmitted:
    run: r:latest analysis/comparisons/apply_model_cox.R ChAdOx 1 covidadmitted
    needs:
    - design
    - preflight_ChAdOx_1_covidadmitted
    outputs:
      highly_sensitive:
        modelnumber: output/models_cox/data/model*_ChAdOx_1_covidadmitted.rds
        model_summary: output/models_cox/data/modelcox_summary_ChAdOx_1_covidadmitted.rds
        model_glance: output/models_cox/data/modelcox_glance_ChAdOx_1_covidadmitted.rds

  ## ChAdOx; 16-64 and clinically vulnerable; coviddeath 
  ## preflight checks 

  preflight_ChAdOx_1_coviddeath:
    run: r:latest analysis/comparisons/preflight.R ChAdOx 1 coviddeath
    needs:
    - design
    - data_comparisons_process
    - data_tte_process_ChAdOx
    outputs:
      highly_sensitive:
        data_cox: output/models_cox/data/data_cox_ChAdOx_1_coviddeath.rds
        model_instructions: output/lib/model_instructions_ChAdOx_1_coviddeath.rds
      moderately_sensitive:
        eventcheck_table: output/models_cox/tables/eventcheck_ChAdOx_1_coviddeath.html

  ## apply cox model 

  apply_model_cox_ChAdOx_1_coviddeath:
    run: r:latest analysis/comparisons/apply_model_cox.R ChAdOx 1 coviddeath
    needs:
    - design
    - preflight_ChAdOx_1_coviddeath
    outputs:
      highly_sensitive:
        modelnumber: output/models_cox/data/model*_ChAdOx_1_coviddeath.rds
        model_summary: output/models_cox/data/modelcox_summary_ChAdOx_1_coviddeath.rds
        model_glance: output/models_cox/data/modelcox_glance_ChAdOx_1_coviddeath.rds

  ## ChAdOx; 16-64 and clinically vulnerable; noncoviddeath 
  ## preflight checks 

  preflight_ChAdOx_1_noncoviddeath:
    run: r:latest analysis/comparisons/preflight.R ChAdOx 1 noncoviddeath
    needs:
    - design
    - data_comparisons_process
    - data_tte_process_ChAdOx
    outputs:
      highly_sensitive:
        data_cox: output/models_cox/data/data_cox_ChAdOx_1_noncoviddeath.rds
        model_instructions: output/lib/model_instructions_ChAdOx_1_noncoviddeath.rds
      moderately_sensitive:
        eventcheck_table: output/models_cox/tables/eventcheck_ChAdOx_1_noncoviddeath.html

  ## apply cox model 

  apply_model_cox_ChAdOx_1_noncoviddeath:
    run: r:latest analysis/comparisons/apply_model_cox.R ChAdOx 1 noncoviddeath
    needs:
    - design
    - preflight_ChAdOx_1_noncoviddeath
    outputs:
      highly_sensitive:
        modelnumber: output/models_cox/data/model*_ChAdOx_1_noncoviddeath.rds
        model_summary: output/models_cox/data/modelcox_summary_ChAdOx_1_noncoviddeath.rds
        model_glance: output/models_cox/data/modelcox_glance_ChAdOx_1_noncoviddeath.rds

  ## ChAdOx; 16-64 and clinically vulnerable; death 
  ## preflight checks 

  preflight_ChAdOx_1_death:
    run: r:latest analysis/comparisons/preflight.R ChAdOx 1 death
    needs:
    - design
    - data_comparisons_process
    - data_tte_process_ChAdOx
    outputs:
      highly_sensitive:
        data_cox: output/models_cox/data/data_cox_ChAdOx_1_death.rds
        model_instructions: output/lib/model_instructions_ChAdOx_1_death.rds
      moderately_sensitive:
        eventcheck_table: output/models_cox/tables/eventcheck_ChAdOx_1_death.html

  ## apply cox model 

  apply_model_cox_ChAdOx_1_death:
    run: r:latest analysis/comparisons/apply_model_cox.R ChAdOx 1 death
    needs:
    - design
    - preflight_ChAdOx_1_death
    outputs:
      highly_sensitive:
        modelnumber: output/models_cox/data/model*_ChAdOx_1_death.rds
        model_summary: output/models_cox/data/modelcox_summary_ChAdOx_1_death.rds
        model_glance: output/models_cox/data/modelcox_glance_ChAdOx_1_death.rds

  ## tabulate cox model for all outcomes 

  tables_model_cox_ChAdOx_1:
    run: r:latest analysis/comparisons/tables_cox.R ChAdOx 1
    needs:
    - design
    - data_2nd_vax_dates
    - data_tte_process_ChAdOx
    - apply_model_cox_ChAdOx_1_postest
    - apply_model_cox_ChAdOx_1_covidadmitted
    - apply_model_cox_ChAdOx_1_coviddeath
    - apply_model_cox_ChAdOx_1_noncoviddeath
    - apply_model_cox_ChAdOx_1_death
    outputs:
      moderately_sensitive:
        table_glance: output/models_cox/tables/modelcox_glance_ChAdOx_1.txt
        table_coefficients: output/models_cox/tables/modelcox_coefficients_ChAdOx_1.txt

  ## ChAdOx; 40-64; postest 
  ## preflight checks 

  preflight_ChAdOx_3_postest:
    run: r:latest analysis/comparisons/preflight.R ChAdOx 3 postest
    needs:
    - design
    - data_comparisons_process
    - data_tte_process_ChAdOx
    outputs:
      highly_sensitive:
        data_cox: output/models_cox/data/data_cox_ChAdOx_3_postest.rds
        model_instructions: output/lib/model_instructions_ChAdOx_3_postest.rds
      moderately_sensitive:
        eventcheck_table: output/models_cox/tables/eventcheck_ChAdOx_3_postest.html

  ## apply cox model 

  apply_model_cox_ChAdOx_3_postest:
    run: r:latest analysis/comparisons/apply_model_cox.R ChAdOx 3 postest
    needs:
    - design
    - preflight_ChAdOx_3_postest
    outputs:
      highly_sensitive:
        modelnumber: output/models_cox/data/model*_ChAdOx_3_postest.rds
        model_summary: output/models_cox/data/modelcox_summary_ChAdOx_3_postest.rds
        model_glance: output/models_cox/data/modelcox_glance_ChAdOx_3_postest.rds

  ## ChAdOx; 40-64; covidadmitted 
  ## preflight checks 

  preflight_ChAdOx_3_covidadmitted:
    run: r:latest analysis/comparisons/preflight.R ChAdOx 3 covidadmitted
    needs:
    - design
    - data_comparisons_process
    - data_tte_process_ChAdOx
    outputs:
      highly_sensitive:
        data_cox: output/models_cox/data/data_cox_ChAdOx_3_covidadmitted.rds
        model_instructions: output/lib/model_instructions_ChAdOx_3_covidadmitted.rds
      moderately_sensitive:
        eventcheck_table: output/models_cox/tables/eventcheck_ChAdOx_3_covidadmitted.html

  ## apply cox model 

  apply_model_cox_ChAdOx_3_covidadmitted:
    run: r:latest analysis/comparisons/apply_model_cox.R ChAdOx 3 covidadmitted
    needs:
    - design
    - preflight_ChAdOx_3_covidadmitted
    outputs:
      highly_sensitive:
        modelnumber: output/models_cox/data/model*_ChAdOx_3_covidadmitted.rds
        model_summary: output/models_cox/data/modelcox_summary_ChAdOx_3_covidadmitted.rds
        model_glance: output/models_cox/data/modelcox_glance_ChAdOx_3_covidadmitted.rds

  ## ChAdOx; 40-64; coviddeath 
  ## preflight checks 

  preflight_ChAdOx_3_coviddeath:
    run: r:latest analysis/comparisons/preflight.R ChAdOx 3 coviddeath
    needs:
    - design
    - data_comparisons_process
    - data_tte_process_ChAdOx
    outputs:
      highly_sensitive:
        data_cox: output/models_cox/data/data_cox_ChAdOx_3_coviddeath.rds
        model_instructions: output/lib/model_instructions_ChAdOx_3_coviddeath.rds
      moderately_sensitive:
        eventcheck_table: output/models_cox/tables/eventcheck_ChAdOx_3_coviddeath.html

  ## apply cox model 

  apply_model_cox_ChAdOx_3_coviddeath:
    run: r:latest analysis/comparisons/apply_model_cox.R ChAdOx 3 coviddeath
    needs:
    - design
    - preflight_ChAdOx_3_coviddeath
    outputs:
      highly_sensitive:
        modelnumber: output/models_cox/data/model*_ChAdOx_3_coviddeath.rds
        model_summary: output/models_cox/data/modelcox_summary_ChAdOx_3_coviddeath.rds
        model_glance: output/models_cox/data/modelcox_glance_ChAdOx_3_coviddeath.rds

  ## ChAdOx; 40-64; noncoviddeath 
  ## preflight checks 

  preflight_ChAdOx_3_noncoviddeath:
    run: r:latest analysis/comparisons/preflight.R ChAdOx 3 noncoviddeath
    needs:
    - design
    - data_comparisons_process
    - data_tte_process_ChAdOx
    outputs:
      highly_sensitive:
        data_cox: output/models_cox/data/data_cox_ChAdOx_3_noncoviddeath.rds
        model_instructions: output/lib/model_instructions_ChAdOx_3_noncoviddeath.rds
      moderately_sensitive:
        eventcheck_table: output/models_cox/tables/eventcheck_ChAdOx_3_noncoviddeath.html

  ## apply cox model 

  apply_model_cox_ChAdOx_3_noncoviddeath:
    run: r:latest analysis/comparisons/apply_model_cox.R ChAdOx 3 noncoviddeath
    needs:
    - design
    - preflight_ChAdOx_3_noncoviddeath
    outputs:
      highly_sensitive:
        modelnumber: output/models_cox/data/model*_ChAdOx_3_noncoviddeath.rds
        model_summary: output/models_cox/data/modelcox_summary_ChAdOx_3_noncoviddeath.rds
        model_glance: output/models_cox/data/modelcox_glance_ChAdOx_3_noncoviddeath.rds

  ## ChAdOx; 40-64; death 
  ## preflight checks 

  preflight_ChAdOx_3_death:
    run: r:latest analysis/comparisons/preflight.R ChAdOx 3 death
    needs:
    - design
    - data_comparisons_process
    - data_tte_process_ChAdOx
    outputs:
      highly_sensitive:
        data_cox: output/models_cox/data/data_cox_ChAdOx_3_death.rds
        model_instructions: output/lib/model_instructions_ChAdOx_3_death.rds
      moderately_sensitive:
        eventcheck_table: output/models_cox/tables/eventcheck_ChAdOx_3_death.html

  ## apply cox model 

  apply_model_cox_ChAdOx_3_death:
    run: r:latest analysis/comparisons/apply_model_cox.R ChAdOx 3 death
    needs:
    - design
    - preflight_ChAdOx_3_death
    outputs:
      highly_sensitive:
        modelnumber: output/models_cox/data/model*_ChAdOx_3_death.rds
        model_summary: output/models_cox/data/modelcox_summary_ChAdOx_3_death.rds
        model_glance: output/models_cox/data/modelcox_glance_ChAdOx_3_death.rds

  ## tabulate cox model for all outcomes 

  tables_model_cox_ChAdOx_3:
    run: r:latest analysis/comparisons/tables_cox.R ChAdOx 3
    needs:
    - design
    - data_2nd_vax_dates
    - data_tte_process_ChAdOx
    - apply_model_cox_ChAdOx_3_postest
    - apply_model_cox_ChAdOx_3_covidadmitted
    - apply_model_cox_ChAdOx_3_coviddeath
    - apply_model_cox_ChAdOx_3_noncoviddeath
    - apply_model_cox_ChAdOx_3_death
    outputs:
      moderately_sensitive:
        table_glance: output/models_cox/tables/modelcox_glance_ChAdOx_3.txt
        table_coefficients: output/models_cox/tables/modelcox_coefficients_ChAdOx_3.txt

  ## ChAdOx; 65+; postest 
  ## preflight checks 

  preflight_ChAdOx_4_postest:
    run: r:latest analysis/comparisons/preflight.R ChAdOx 4 postest
    needs:
    - design
    - data_comparisons_process
    - data_tte_process_ChAdOx
    outputs:
      highly_sensitive:
        data_cox: output/models_cox/data/data_cox_ChAdOx_4_postest.rds
        model_instructions: output/lib/model_instructions_ChAdOx_4_postest.rds
      moderately_sensitive:
        eventcheck_table: output/models_cox/tables/eventcheck_ChAdOx_4_postest.html

  ## apply cox model 

  apply_model_cox_ChAdOx_4_postest:
    run: r:latest analysis/comparisons/apply_model_cox.R ChAdOx 4 postest
    needs:
    - design
    - preflight_ChAdOx_4_postest
    outputs:
      highly_sensitive:
        modelnumber: output/models_cox/data/model*_ChAdOx_4_postest.rds
        model_summary: output/models_cox/data/modelcox_summary_ChAdOx_4_postest.rds
        model_glance: output/models_cox/data/modelcox_glance_ChAdOx_4_postest.rds

  ## ChAdOx; 65+; covidadmitted 
  ## preflight checks 

  preflight_ChAdOx_4_covidadmitted:
    run: r:latest analysis/comparisons/preflight.R ChAdOx 4 covidadmitted
    needs:
    - design
    - data_comparisons_process
    - data_tte_process_ChAdOx
    outputs:
      highly_sensitive:
        data_cox: output/models_cox/data/data_cox_ChAdOx_4_covidadmitted.rds
        model_instructions: output/lib/model_instructions_ChAdOx_4_covidadmitted.rds
      moderately_sensitive:
        eventcheck_table: output/models_cox/tables/eventcheck_ChAdOx_4_covidadmitted.html

  ## apply cox model 

  apply_model_cox_ChAdOx_4_covidadmitted:
    run: r:latest analysis/comparisons/apply_model_cox.R ChAdOx 4 covidadmitted
    needs:
    - design
    - preflight_ChAdOx_4_covidadmitted
    outputs:
      highly_sensitive:
        modelnumber: output/models_cox/data/model*_ChAdOx_4_covidadmitted.rds
        model_summary: output/models_cox/data/modelcox_summary_ChAdOx_4_covidadmitted.rds
        model_glance: output/models_cox/data/modelcox_glance_ChAdOx_4_covidadmitted.rds

  ## ChAdOx; 65+; coviddeath 
  ## preflight checks 

  preflight_ChAdOx_4_coviddeath:
    run: r:latest analysis/comparisons/preflight.R ChAdOx 4 coviddeath
    needs:
    - design
    - data_comparisons_process
    - data_tte_process_ChAdOx
    outputs:
      highly_sensitive:
        data_cox: output/models_cox/data/data_cox_ChAdOx_4_coviddeath.rds
        model_instructions: output/lib/model_instructions_ChAdOx_4_coviddeath.rds
      moderately_sensitive:
        eventcheck_table: output/models_cox/tables/eventcheck_ChAdOx_4_coviddeath.html

  ## apply cox model 

  apply_model_cox_ChAdOx_4_coviddeath:
    run: r:latest analysis/comparisons/apply_model_cox.R ChAdOx 4 coviddeath
    needs:
    - design
    - preflight_ChAdOx_4_coviddeath
    outputs:
      highly_sensitive:
        modelnumber: output/models_cox/data/model*_ChAdOx_4_coviddeath.rds
        model_summary: output/models_cox/data/modelcox_summary_ChAdOx_4_coviddeath.rds
        model_glance: output/models_cox/data/modelcox_glance_ChAdOx_4_coviddeath.rds

  ## ChAdOx; 65+; noncoviddeath 
  ## preflight checks 

  preflight_ChAdOx_4_noncoviddeath:
    run: r:latest analysis/comparisons/preflight.R ChAdOx 4 noncoviddeath
    needs:
    - design
    - data_comparisons_process
    - data_tte_process_ChAdOx
    outputs:
      highly_sensitive:
        data_cox: output/models_cox/data/data_cox_ChAdOx_4_noncoviddeath.rds
        model_instructions: output/lib/model_instructions_ChAdOx_4_noncoviddeath.rds
      moderately_sensitive:
        eventcheck_table: output/models_cox/tables/eventcheck_ChAdOx_4_noncoviddeath.html

  ## apply cox model 

  apply_model_cox_ChAdOx_4_noncoviddeath:
    run: r:latest analysis/comparisons/apply_model_cox.R ChAdOx 4 noncoviddeath
    needs:
    - design
    - preflight_ChAdOx_4_noncoviddeath
    outputs:
      highly_sensitive:
        modelnumber: output/models_cox/data/model*_ChAdOx_4_noncoviddeath.rds
        model_summary: output/models_cox/data/modelcox_summary_ChAdOx_4_noncoviddeath.rds
        model_glance: output/models_cox/data/modelcox_glance_ChAdOx_4_noncoviddeath.rds

  ## ChAdOx; 65+; death 
  ## preflight checks 

  preflight_ChAdOx_4_death:
    run: r:latest analysis/comparisons/preflight.R ChAdOx 4 death
    needs:
    - design
    - data_comparisons_process
    - data_tte_process_ChAdOx
    outputs:
      highly_sensitive:
        data_cox: output/models_cox/data/data_cox_ChAdOx_4_death.rds
        model_instructions: output/lib/model_instructions_ChAdOx_4_death.rds
      moderately_sensitive:
        eventcheck_table: output/models_cox/tables/eventcheck_ChAdOx_4_death.html

  ## apply cox model 

  apply_model_cox_ChAdOx_4_death:
    run: r:latest analysis/comparisons/apply_model_cox.R ChAdOx 4 death
    needs:
    - design
    - preflight_ChAdOx_4_death
    outputs:
      highly_sensitive:
        modelnumber: output/models_cox/data/model*_ChAdOx_4_death.rds
        model_summary: output/models_cox/data/modelcox_summary_ChAdOx_4_death.rds
        model_glance: output/models_cox/data/modelcox_glance_ChAdOx_4_death.rds

  ## tabulate cox model for all outcomes 

  tables_model_cox_ChAdOx_4:
    run: r:latest analysis/comparisons/tables_cox.R ChAdOx 4
    needs:
    - design
    - data_2nd_vax_dates
    - data_tte_process_ChAdOx
    - apply_model_cox_ChAdOx_4_postest
    - apply_model_cox_ChAdOx_4_covidadmitted
    - apply_model_cox_ChAdOx_4_coviddeath
    - apply_model_cox_ChAdOx_4_noncoviddeath
    - apply_model_cox_ChAdOx_4_death
    outputs:
      moderately_sensitive:
        table_glance: output/models_cox/tables/modelcox_glance_ChAdOx_4.txt
        table_coefficients: output/models_cox/tables/modelcox_coefficients_ChAdOx_4.txt

  ## ChAdOx; all; postest 
  ## preflight checks 

  preflight_ChAdOx_5_postest:
    run: r:latest analysis/comparisons/preflight.R ChAdOx 5 postest
    needs:
    - design
    - data_comparisons_process
    - data_tte_process_ChAdOx
    outputs:
      highly_sensitive:
        data_cox: output/models_cox/data/data_cox_ChAdOx_5_postest.rds
        model_instructions: output/lib/model_instructions_ChAdOx_5_postest.rds
      moderately_sensitive:
        eventcheck_table: output/models_cox/tables/eventcheck_ChAdOx_5_postest.html

  ## apply cox model 

  apply_model_cox_ChAdOx_5_postest:
    run: r:latest analysis/comparisons/apply_model_cox.R ChAdOx 5 postest
    needs:
    - design
    - preflight_ChAdOx_5_postest
    outputs:
      highly_sensitive:
        modelnumber: output/models_cox/data/model*_ChAdOx_5_postest.rds
        model_summary: output/models_cox/data/modelcox_summary_ChAdOx_5_postest.rds
        model_glance: output/models_cox/data/modelcox_glance_ChAdOx_5_postest.rds

  ## ChAdOx; all; covidadmitted 
  ## preflight checks 

  preflight_ChAdOx_5_covidadmitted:
    run: r:latest analysis/comparisons/preflight.R ChAdOx 5 covidadmitted
    needs:
    - design
    - data_comparisons_process
    - data_tte_process_ChAdOx
    outputs:
      highly_sensitive:
        data_cox: output/models_cox/data/data_cox_ChAdOx_5_covidadmitted.rds
        model_instructions: output/lib/model_instructions_ChAdOx_5_covidadmitted.rds
      moderately_sensitive:
        eventcheck_table: output/models_cox/tables/eventcheck_ChAdOx_5_covidadmitted.html

  ## apply cox model 

  apply_model_cox_ChAdOx_5_covidadmitted:
    run: r:latest analysis/comparisons/apply_model_cox.R ChAdOx 5 covidadmitted
    needs:
    - design
    - preflight_ChAdOx_5_covidadmitted
    outputs:
      highly_sensitive:
        modelnumber: output/models_cox/data/model*_ChAdOx_5_covidadmitted.rds
        model_summary: output/models_cox/data/modelcox_summary_ChAdOx_5_covidadmitted.rds
        model_glance: output/models_cox/data/modelcox_glance_ChAdOx_5_covidadmitted.rds

  ## ChAdOx; all; coviddeath 
  ## preflight checks 

  preflight_ChAdOx_5_coviddeath:
    run: r:latest analysis/comparisons/preflight.R ChAdOx 5 coviddeath
    needs:
    - design
    - data_comparisons_process
    - data_tte_process_ChAdOx
    outputs:
      highly_sensitive:
        data_cox: output/models_cox/data/data_cox_ChAdOx_5_coviddeath.rds
        model_instructions: output/lib/model_instructions_ChAdOx_5_coviddeath.rds
      moderately_sensitive:
        eventcheck_table: output/models_cox/tables/eventcheck_ChAdOx_5_coviddeath.html

  ## apply cox model 

  apply_model_cox_ChAdOx_5_coviddeath:
    run: r:latest analysis/comparisons/apply_model_cox.R ChAdOx 5 coviddeath
    needs:
    - design
    - preflight_ChAdOx_5_coviddeath
    outputs:
      highly_sensitive:
        modelnumber: output/models_cox/data/model*_ChAdOx_5_coviddeath.rds
        model_summary: output/models_cox/data/modelcox_summary_ChAdOx_5_coviddeath.rds
        model_glance: output/models_cox/data/modelcox_glance_ChAdOx_5_coviddeath.rds

  ## ChAdOx; all; noncoviddeath 
  ## preflight checks 

  preflight_ChAdOx_5_noncoviddeath:
    run: r:latest analysis/comparisons/preflight.R ChAdOx 5 noncoviddeath
    needs:
    - design
    - data_comparisons_process
    - data_tte_process_ChAdOx
    outputs:
      highly_sensitive:
        data_cox: output/models_cox/data/data_cox_ChAdOx_5_noncoviddeath.rds
        model_instructions: output/lib/model_instructions_ChAdOx_5_noncoviddeath.rds
      moderately_sensitive:
        eventcheck_table: output/models_cox/tables/eventcheck_ChAdOx_5_noncoviddeath.html

  ## apply cox model 

  apply_model_cox_ChAdOx_5_noncoviddeath:
    run: r:latest analysis/comparisons/apply_model_cox.R ChAdOx 5 noncoviddeath
    needs:
    - design
    - preflight_ChAdOx_5_noncoviddeath
    outputs:
      highly_sensitive:
        modelnumber: output/models_cox/data/model*_ChAdOx_5_noncoviddeath.rds
        model_summary: output/models_cox/data/modelcox_summary_ChAdOx_5_noncoviddeath.rds
        model_glance: output/models_cox/data/modelcox_glance_ChAdOx_5_noncoviddeath.rds

  ## ChAdOx; all; death 
  ## preflight checks 

  preflight_ChAdOx_5_death:
    run: r:latest analysis/comparisons/preflight.R ChAdOx 5 death
    needs:
    - design
    - data_comparisons_process
    - data_tte_process_ChAdOx
    outputs:
      highly_sensitive:
        data_cox: output/models_cox/data/data_cox_ChAdOx_5_death.rds
        model_instructions: output/lib/model_instructions_ChAdOx_5_death.rds
      moderately_sensitive:
        eventcheck_table: output/models_cox/tables/eventcheck_ChAdOx_5_death.html

  ## apply cox model 

  apply_model_cox_ChAdOx_5_death:
    run: r:latest analysis/comparisons/apply_model_cox.R ChAdOx 5 death
    needs:
    - design
    - preflight_ChAdOx_5_death
    outputs:
      highly_sensitive:
        modelnumber: output/models_cox/data/model*_ChAdOx_5_death.rds
        model_summary: output/models_cox/data/modelcox_summary_ChAdOx_5_death.rds
        model_glance: output/models_cox/data/modelcox_glance_ChAdOx_5_death.rds

  ## tabulate cox model for all outcomes 

  tables_model_cox_ChAdOx_5:
    run: r:latest analysis/comparisons/tables_cox.R ChAdOx 5
    needs:
    - design
    - data_2nd_vax_dates
    - data_tte_process_ChAdOx
    - apply_model_cox_ChAdOx_5_postest
    - apply_model_cox_ChAdOx_5_covidadmitted
    - apply_model_cox_ChAdOx_5_coviddeath
    - apply_model_cox_ChAdOx_5_noncoviddeath
    - apply_model_cox_ChAdOx_5_death
    outputs:
      moderately_sensitive:
        table_glance: output/models_cox/tables/modelcox_glance_ChAdOx_5.txt
        table_coefficients: output/models_cox/tables/modelcox_coefficients_ChAdOx_5.txt

  ## both; 16-64 and clinically vulnerable; postest 
  ## preflight checks 

  preflight_both_1_postest:
    run: r:latest analysis/comparisons/preflight.R both 1 postest
    needs:
    - design
    - data_comparisons_process
    - data_tte_process_both
    outputs:
      highly_sensitive:
        data_cox: output/models_cox/data/data_cox_both_1_postest.rds
        model_instructions: output/lib/model_instructions_both_1_postest.rds
      moderately_sensitive:
        eventcheck_table: output/models_cox/tables/eventcheck_both_1_postest.html

  ## apply cox model 

  apply_model_cox_both_1_postest:
    run: r:latest analysis/comparisons/apply_model_cox.R both 1 postest
    needs:
    - design
    - preflight_both_1_postest
    outputs:
      highly_sensitive:
        modelnumber: output/models_cox/data/model*_both_1_postest.rds
        model_summary: output/models_cox/data/modelcox_summary_both_1_postest.rds
        model_glance: output/models_cox/data/modelcox_glance_both_1_postest.rds

  ## both; 16-64 and clinically vulnerable; covidadmitted 
  ## preflight checks 

  preflight_both_1_covidadmitted:
    run: r:latest analysis/comparisons/preflight.R both 1 covidadmitted
    needs:
    - design
    - data_comparisons_process
    - data_tte_process_both
    outputs:
      highly_sensitive:
        data_cox: output/models_cox/data/data_cox_both_1_covidadmitted.rds
        model_instructions: output/lib/model_instructions_both_1_covidadmitted.rds
      moderately_sensitive:
        eventcheck_table: output/models_cox/tables/eventcheck_both_1_covidadmitted.html

  ## apply cox model 

  apply_model_cox_both_1_covidadmitted:
    run: r:latest analysis/comparisons/apply_model_cox.R both 1 covidadmitted
    needs:
    - design
    - preflight_both_1_covidadmitted
    outputs:
      highly_sensitive:
        modelnumber: output/models_cox/data/model*_both_1_covidadmitted.rds
        model_summary: output/models_cox/data/modelcox_summary_both_1_covidadmitted.rds
        model_glance: output/models_cox/data/modelcox_glance_both_1_covidadmitted.rds

  ## both; 16-64 and clinically vulnerable; coviddeath 
  ## preflight checks 

  preflight_both_1_coviddeath:
    run: r:latest analysis/comparisons/preflight.R both 1 coviddeath
    needs:
    - design
    - data_comparisons_process
    - data_tte_process_both
    outputs:
      highly_sensitive:
        data_cox: output/models_cox/data/data_cox_both_1_coviddeath.rds
        model_instructions: output/lib/model_instructions_both_1_coviddeath.rds
      moderately_sensitive:
        eventcheck_table: output/models_cox/tables/eventcheck_both_1_coviddeath.html

  ## apply cox model 

  apply_model_cox_both_1_coviddeath:
    run: r:latest analysis/comparisons/apply_model_cox.R both 1 coviddeath
    needs:
    - design
    - preflight_both_1_coviddeath
    outputs:
      highly_sensitive:
        modelnumber: output/models_cox/data/model*_both_1_coviddeath.rds
        model_summary: output/models_cox/data/modelcox_summary_both_1_coviddeath.rds
        model_glance: output/models_cox/data/modelcox_glance_both_1_coviddeath.rds

  ## both; 16-64 and clinically vulnerable; noncoviddeath 
  ## preflight checks 

  preflight_both_1_noncoviddeath:
    run: r:latest analysis/comparisons/preflight.R both 1 noncoviddeath
    needs:
    - design
    - data_comparisons_process
    - data_tte_process_both
    outputs:
      highly_sensitive:
        data_cox: output/models_cox/data/data_cox_both_1_noncoviddeath.rds
        model_instructions: output/lib/model_instructions_both_1_noncoviddeath.rds
      moderately_sensitive:
        eventcheck_table: output/models_cox/tables/eventcheck_both_1_noncoviddeath.html

  ## apply cox model 

  apply_model_cox_both_1_noncoviddeath:
    run: r:latest analysis/comparisons/apply_model_cox.R both 1 noncoviddeath
    needs:
    - design
    - preflight_both_1_noncoviddeath
    outputs:
      highly_sensitive:
        modelnumber: output/models_cox/data/model*_both_1_noncoviddeath.rds
        model_summary: output/models_cox/data/modelcox_summary_both_1_noncoviddeath.rds
        model_glance: output/models_cox/data/modelcox_glance_both_1_noncoviddeath.rds

  ## both; 16-64 and clinically vulnerable; death 
  ## preflight checks 

  preflight_both_1_death:
    run: r:latest analysis/comparisons/preflight.R both 1 death
    needs:
    - design
    - data_comparisons_process
    - data_tte_process_both
    outputs:
      highly_sensitive:
        data_cox: output/models_cox/data/data_cox_both_1_death.rds
        model_instructions: output/lib/model_instructions_both_1_death.rds
      moderately_sensitive:
        eventcheck_table: output/models_cox/tables/eventcheck_both_1_death.html

  ## apply cox model 

  apply_model_cox_both_1_death:
    run: r:latest analysis/comparisons/apply_model_cox.R both 1 death
    needs:
    - design
    - preflight_both_1_death
    outputs:
      highly_sensitive:
        modelnumber: output/models_cox/data/model*_both_1_death.rds
        model_summary: output/models_cox/data/modelcox_summary_both_1_death.rds
        model_glance: output/models_cox/data/modelcox_glance_both_1_death.rds

  ## tabulate cox model for all outcomes 

  tables_model_cox_both_1:
    run: r:latest analysis/comparisons/tables_cox.R both 1
    needs:
    - design
    - data_2nd_vax_dates
    - data_tte_process_both
    - apply_model_cox_both_1_postest
    - apply_model_cox_both_1_covidadmitted
    - apply_model_cox_both_1_coviddeath
    - apply_model_cox_both_1_noncoviddeath
    - apply_model_cox_both_1_death
    outputs:
      moderately_sensitive:
        table_glance: output/models_cox/tables/modelcox_glance_both_1.txt
        table_coefficients: output/models_cox/tables/modelcox_coefficients_both_1.txt

  ## both; 40-64; postest 
  ## preflight checks 

  preflight_both_3_postest:
    run: r:latest analysis/comparisons/preflight.R both 3 postest
    needs:
    - design
    - data_comparisons_process
    - data_tte_process_both
    outputs:
      highly_sensitive:
        data_cox: output/models_cox/data/data_cox_both_3_postest.rds
        model_instructions: output/lib/model_instructions_both_3_postest.rds
      moderately_sensitive:
        eventcheck_table: output/models_cox/tables/eventcheck_both_3_postest.html

  ## apply cox model 

  apply_model_cox_both_3_postest:
    run: r:latest analysis/comparisons/apply_model_cox.R both 3 postest
    needs:
    - design
    - preflight_both_3_postest
    outputs:
      highly_sensitive:
        modelnumber: output/models_cox/data/model*_both_3_postest.rds
        model_summary: output/models_cox/data/modelcox_summary_both_3_postest.rds
        model_glance: output/models_cox/data/modelcox_glance_both_3_postest.rds

  ## both; 40-64; covidadmitted 
  ## preflight checks 

  preflight_both_3_covidadmitted:
    run: r:latest analysis/comparisons/preflight.R both 3 covidadmitted
    needs:
    - design
    - data_comparisons_process
    - data_tte_process_both
    outputs:
      highly_sensitive:
        data_cox: output/models_cox/data/data_cox_both_3_covidadmitted.rds
        model_instructions: output/lib/model_instructions_both_3_covidadmitted.rds
      moderately_sensitive:
        eventcheck_table: output/models_cox/tables/eventcheck_both_3_covidadmitted.html

  ## apply cox model 

  apply_model_cox_both_3_covidadmitted:
    run: r:latest analysis/comparisons/apply_model_cox.R both 3 covidadmitted
    needs:
    - design
    - preflight_both_3_covidadmitted
    outputs:
      highly_sensitive:
        modelnumber: output/models_cox/data/model*_both_3_covidadmitted.rds
        model_summary: output/models_cox/data/modelcox_summary_both_3_covidadmitted.rds
        model_glance: output/models_cox/data/modelcox_glance_both_3_covidadmitted.rds

  ## both; 40-64; coviddeath 
  ## preflight checks 

  preflight_both_3_coviddeath:
    run: r:latest analysis/comparisons/preflight.R both 3 coviddeath
    needs:
    - design
    - data_comparisons_process
    - data_tte_process_both
    outputs:
      highly_sensitive:
        data_cox: output/models_cox/data/data_cox_both_3_coviddeath.rds
        model_instructions: output/lib/model_instructions_both_3_coviddeath.rds
      moderately_sensitive:
        eventcheck_table: output/models_cox/tables/eventcheck_both_3_coviddeath.html

  ## apply cox model 

  apply_model_cox_both_3_coviddeath:
    run: r:latest analysis/comparisons/apply_model_cox.R both 3 coviddeath
    needs:
    - design
    - preflight_both_3_coviddeath
    outputs:
      highly_sensitive:
        modelnumber: output/models_cox/data/model*_both_3_coviddeath.rds
        model_summary: output/models_cox/data/modelcox_summary_both_3_coviddeath.rds
        model_glance: output/models_cox/data/modelcox_glance_both_3_coviddeath.rds

  ## both; 40-64; noncoviddeath 
  ## preflight checks 

  preflight_both_3_noncoviddeath:
    run: r:latest analysis/comparisons/preflight.R both 3 noncoviddeath
    needs:
    - design
    - data_comparisons_process
    - data_tte_process_both
    outputs:
      highly_sensitive:
        data_cox: output/models_cox/data/data_cox_both_3_noncoviddeath.rds
        model_instructions: output/lib/model_instructions_both_3_noncoviddeath.rds
      moderately_sensitive:
        eventcheck_table: output/models_cox/tables/eventcheck_both_3_noncoviddeath.html

  ## apply cox model 

  apply_model_cox_both_3_noncoviddeath:
    run: r:latest analysis/comparisons/apply_model_cox.R both 3 noncoviddeath
    needs:
    - design
    - preflight_both_3_noncoviddeath
    outputs:
      highly_sensitive:
        modelnumber: output/models_cox/data/model*_both_3_noncoviddeath.rds
        model_summary: output/models_cox/data/modelcox_summary_both_3_noncoviddeath.rds
        model_glance: output/models_cox/data/modelcox_glance_both_3_noncoviddeath.rds

  ## both; 40-64; death 
  ## preflight checks 

  preflight_both_3_death:
    run: r:latest analysis/comparisons/preflight.R both 3 death
    needs:
    - design
    - data_comparisons_process
    - data_tte_process_both
    outputs:
      highly_sensitive:
        data_cox: output/models_cox/data/data_cox_both_3_death.rds
        model_instructions: output/lib/model_instructions_both_3_death.rds
      moderately_sensitive:
        eventcheck_table: output/models_cox/tables/eventcheck_both_3_death.html

  ## apply cox model 

  apply_model_cox_both_3_death:
    run: r:latest analysis/comparisons/apply_model_cox.R both 3 death
    needs:
    - design
    - preflight_both_3_death
    outputs:
      highly_sensitive:
        modelnumber: output/models_cox/data/model*_both_3_death.rds
        model_summary: output/models_cox/data/modelcox_summary_both_3_death.rds
        model_glance: output/models_cox/data/modelcox_glance_both_3_death.rds

  ## tabulate cox model for all outcomes 

  tables_model_cox_both_3:
    run: r:latest analysis/comparisons/tables_cox.R both 3
    needs:
    - design
    - data_2nd_vax_dates
    - data_tte_process_both
    - apply_model_cox_both_3_postest
    - apply_model_cox_both_3_covidadmitted
    - apply_model_cox_both_3_coviddeath
    - apply_model_cox_both_3_noncoviddeath
    - apply_model_cox_both_3_death
    outputs:
      moderately_sensitive:
        table_glance: output/models_cox/tables/modelcox_glance_both_3.txt
        table_coefficients: output/models_cox/tables/modelcox_coefficients_both_3.txt

  ## both; 65+; postest 
  ## preflight checks 

  preflight_both_4_postest:
    run: r:latest analysis/comparisons/preflight.R both 4 postest
    needs:
    - design
    - data_comparisons_process
    - data_tte_process_both
    outputs:
      highly_sensitive:
        data_cox: output/models_cox/data/data_cox_both_4_postest.rds
        model_instructions: output/lib/model_instructions_both_4_postest.rds
      moderately_sensitive:
        eventcheck_table: output/models_cox/tables/eventcheck_both_4_postest.html

  ## apply cox model 

  apply_model_cox_both_4_postest:
    run: r:latest analysis/comparisons/apply_model_cox.R both 4 postest
    needs:
    - design
    - preflight_both_4_postest
    outputs:
      highly_sensitive:
        modelnumber: output/models_cox/data/model*_both_4_postest.rds
        model_summary: output/models_cox/data/modelcox_summary_both_4_postest.rds
        model_glance: output/models_cox/data/modelcox_glance_both_4_postest.rds

  ## both; 65+; covidadmitted 
  ## preflight checks 

  preflight_both_4_covidadmitted:
    run: r:latest analysis/comparisons/preflight.R both 4 covidadmitted
    needs:
    - design
    - data_comparisons_process
    - data_tte_process_both
    outputs:
      highly_sensitive:
        data_cox: output/models_cox/data/data_cox_both_4_covidadmitted.rds
        model_instructions: output/lib/model_instructions_both_4_covidadmitted.rds
      moderately_sensitive:
        eventcheck_table: output/models_cox/tables/eventcheck_both_4_covidadmitted.html

  ## apply cox model 

  apply_model_cox_both_4_covidadmitted:
    run: r:latest analysis/comparisons/apply_model_cox.R both 4 covidadmitted
    needs:
    - design
    - preflight_both_4_covidadmitted
    outputs:
      highly_sensitive:
        modelnumber: output/models_cox/data/model*_both_4_covidadmitted.rds
        model_summary: output/models_cox/data/modelcox_summary_both_4_covidadmitted.rds
        model_glance: output/models_cox/data/modelcox_glance_both_4_covidadmitted.rds

  ## both; 65+; coviddeath 
  ## preflight checks 

  preflight_both_4_coviddeath:
    run: r:latest analysis/comparisons/preflight.R both 4 coviddeath
    needs:
    - design
    - data_comparisons_process
    - data_tte_process_both
    outputs:
      highly_sensitive:
        data_cox: output/models_cox/data/data_cox_both_4_coviddeath.rds
        model_instructions: output/lib/model_instructions_both_4_coviddeath.rds
      moderately_sensitive:
        eventcheck_table: output/models_cox/tables/eventcheck_both_4_coviddeath.html

  ## apply cox model 

  apply_model_cox_both_4_coviddeath:
    run: r:latest analysis/comparisons/apply_model_cox.R both 4 coviddeath
    needs:
    - design
    - preflight_both_4_coviddeath
    outputs:
      highly_sensitive:
        modelnumber: output/models_cox/data/model*_both_4_coviddeath.rds
        model_summary: output/models_cox/data/modelcox_summary_both_4_coviddeath.rds
        model_glance: output/models_cox/data/modelcox_glance_both_4_coviddeath.rds

  ## both; 65+; noncoviddeath 
  ## preflight checks 

  preflight_both_4_noncoviddeath:
    run: r:latest analysis/comparisons/preflight.R both 4 noncoviddeath
    needs:
    - design
    - data_comparisons_process
    - data_tte_process_both
    outputs:
      highly_sensitive:
        data_cox: output/models_cox/data/data_cox_both_4_noncoviddeath.rds
        model_instructions: output/lib/model_instructions_both_4_noncoviddeath.rds
      moderately_sensitive:
        eventcheck_table: output/models_cox/tables/eventcheck_both_4_noncoviddeath.html

  ## apply cox model 

  apply_model_cox_both_4_noncoviddeath:
    run: r:latest analysis/comparisons/apply_model_cox.R both 4 noncoviddeath
    needs:
    - design
    - preflight_both_4_noncoviddeath
    outputs:
      highly_sensitive:
        modelnumber: output/models_cox/data/model*_both_4_noncoviddeath.rds
        model_summary: output/models_cox/data/modelcox_summary_both_4_noncoviddeath.rds
        model_glance: output/models_cox/data/modelcox_glance_both_4_noncoviddeath.rds

  ## both; 65+; death 
  ## preflight checks 

  preflight_both_4_death:
    run: r:latest analysis/comparisons/preflight.R both 4 death
    needs:
    - design
    - data_comparisons_process
    - data_tte_process_both
    outputs:
      highly_sensitive:
        data_cox: output/models_cox/data/data_cox_both_4_death.rds
        model_instructions: output/lib/model_instructions_both_4_death.rds
      moderately_sensitive:
        eventcheck_table: output/models_cox/tables/eventcheck_both_4_death.html

  ## apply cox model 

  apply_model_cox_both_4_death:
    run: r:latest analysis/comparisons/apply_model_cox.R both 4 death
    needs:
    - design
    - preflight_both_4_death
    outputs:
      highly_sensitive:
        modelnumber: output/models_cox/data/model*_both_4_death.rds
        model_summary: output/models_cox/data/modelcox_summary_both_4_death.rds
        model_glance: output/models_cox/data/modelcox_glance_both_4_death.rds

  ## tabulate cox model for all outcomes 

  tables_model_cox_both_4:
    run: r:latest analysis/comparisons/tables_cox.R both 4
    needs:
    - design
    - data_2nd_vax_dates
    - data_tte_process_both
    - apply_model_cox_both_4_postest
    - apply_model_cox_both_4_covidadmitted
    - apply_model_cox_both_4_coviddeath
    - apply_model_cox_both_4_noncoviddeath
    - apply_model_cox_both_4_death
    outputs:
      moderately_sensitive:
        table_glance: output/models_cox/tables/modelcox_glance_both_4.txt
        table_coefficients: output/models_cox/tables/modelcox_coefficients_both_4.txt

  ## both; all; postest 
  ## preflight checks 

  preflight_both_5_postest:
    run: r:latest analysis/comparisons/preflight.R both 5 postest
    needs:
    - design
    - data_comparisons_process
    - data_tte_process_both
    outputs:
      highly_sensitive:
        data_cox: output/models_cox/data/data_cox_both_5_postest.rds
        model_instructions: output/lib/model_instructions_both_5_postest.rds
      moderately_sensitive:
        eventcheck_table: output/models_cox/tables/eventcheck_both_5_postest.html

  ## apply cox model 

  apply_model_cox_both_5_postest:
    run: r:latest analysis/comparisons/apply_model_cox.R both 5 postest
    needs:
    - design
    - preflight_both_5_postest
    outputs:
      highly_sensitive:
        modelnumber: output/models_cox/data/model*_both_5_postest.rds
        model_summary: output/models_cox/data/modelcox_summary_both_5_postest.rds
        model_glance: output/models_cox/data/modelcox_glance_both_5_postest.rds

  ## both; all; covidadmitted 
  ## preflight checks 

  preflight_both_5_covidadmitted:
    run: r:latest analysis/comparisons/preflight.R both 5 covidadmitted
    needs:
    - design
    - data_comparisons_process
    - data_tte_process_both
    outputs:
      highly_sensitive:
        data_cox: output/models_cox/data/data_cox_both_5_covidadmitted.rds
        model_instructions: output/lib/model_instructions_both_5_covidadmitted.rds
      moderately_sensitive:
        eventcheck_table: output/models_cox/tables/eventcheck_both_5_covidadmitted.html

  ## apply cox model 

  apply_model_cox_both_5_covidadmitted:
    run: r:latest analysis/comparisons/apply_model_cox.R both 5 covidadmitted
    needs:
    - design
    - preflight_both_5_covidadmitted
    outputs:
      highly_sensitive:
        modelnumber: output/models_cox/data/model*_both_5_covidadmitted.rds
        model_summary: output/models_cox/data/modelcox_summary_both_5_covidadmitted.rds
        model_glance: output/models_cox/data/modelcox_glance_both_5_covidadmitted.rds

  ## both; all; coviddeath 
  ## preflight checks 

  preflight_both_5_coviddeath:
    run: r:latest analysis/comparisons/preflight.R both 5 coviddeath
    needs:
    - design
    - data_comparisons_process
    - data_tte_process_both
    outputs:
      highly_sensitive:
        data_cox: output/models_cox/data/data_cox_both_5_coviddeath.rds
        model_instructions: output/lib/model_instructions_both_5_coviddeath.rds
      moderately_sensitive:
        eventcheck_table: output/models_cox/tables/eventcheck_both_5_coviddeath.html

  ## apply cox model 

  apply_model_cox_both_5_coviddeath:
    run: r:latest analysis/comparisons/apply_model_cox.R both 5 coviddeath
    needs:
    - design
    - preflight_both_5_coviddeath
    outputs:
      highly_sensitive:
        modelnumber: output/models_cox/data/model*_both_5_coviddeath.rds
        model_summary: output/models_cox/data/modelcox_summary_both_5_coviddeath.rds
        model_glance: output/models_cox/data/modelcox_glance_both_5_coviddeath.rds

  ## both; all; noncoviddeath 
  ## preflight checks 

  preflight_both_5_noncoviddeath:
    run: r:latest analysis/comparisons/preflight.R both 5 noncoviddeath
    needs:
    - design
    - data_comparisons_process
    - data_tte_process_both
    outputs:
      highly_sensitive:
        data_cox: output/models_cox/data/data_cox_both_5_noncoviddeath.rds
        model_instructions: output/lib/model_instructions_both_5_noncoviddeath.rds
      moderately_sensitive:
        eventcheck_table: output/models_cox/tables/eventcheck_both_5_noncoviddeath.html

  ## apply cox model 

  apply_model_cox_both_5_noncoviddeath:
    run: r:latest analysis/comparisons/apply_model_cox.R both 5 noncoviddeath
    needs:
    - design
    - preflight_both_5_noncoviddeath
    outputs:
      highly_sensitive:
        modelnumber: output/models_cox/data/model*_both_5_noncoviddeath.rds
        model_summary: output/models_cox/data/modelcox_summary_both_5_noncoviddeath.rds
        model_glance: output/models_cox/data/modelcox_glance_both_5_noncoviddeath.rds

  ## both; all; death 
  ## preflight checks 

  preflight_both_5_death:
    run: r:latest analysis/comparisons/preflight.R both 5 death
    needs:
    - design
    - data_comparisons_process
    - data_tte_process_both
    outputs:
      highly_sensitive:
        data_cox: output/models_cox/data/data_cox_both_5_death.rds
        model_instructions: output/lib/model_instructions_both_5_death.rds
      moderately_sensitive:
        eventcheck_table: output/models_cox/tables/eventcheck_both_5_death.html

  ## apply cox model 

  apply_model_cox_both_5_death:
    run: r:latest analysis/comparisons/apply_model_cox.R both 5 death
    needs:
    - design
    - preflight_both_5_death
    outputs:
      highly_sensitive:
        modelnumber: output/models_cox/data/model*_both_5_death.rds
        model_summary: output/models_cox/data/modelcox_summary_both_5_death.rds
        model_glance: output/models_cox/data/modelcox_glance_both_5_death.rds

  ## tabulate cox model for all outcomes 

  tables_model_cox_both_5:
    run: r:latest analysis/comparisons/tables_cox.R both 5
    needs:
    - design
    - data_2nd_vax_dates
    - data_tte_process_both
    - apply_model_cox_both_5_postest
    - apply_model_cox_both_5_covidadmitted
    - apply_model_cox_both_5_coviddeath
    - apply_model_cox_both_5_noncoviddeath
    - apply_model_cox_both_5_death
    outputs:
      moderately_sensitive:
        table_glance: output/models_cox/tables/modelcox_glance_both_5.txt
        table_coefficients: output/models_cox/tables/modelcox_coefficients_both_5.txt

  ## generate plots 
  ## plot BNT162b2 

  plot_model_cox_BNT162b2:
    run: r:latest analysis/comparisons/plot_cox.R BNT162b2
    needs:
    - design
    - data_2nd_vax_dates
    - apply_model_cox_BNT162b2_1_postest
    - apply_model_cox_BNT162b2_1_covidadmitted
    - apply_model_cox_BNT162b2_1_coviddeath
    - apply_model_cox_BNT162b2_1_noncoviddeath
    - apply_model_cox_BNT162b2_1_death
    - apply_model_cox_BNT162b2_2_postest
    - apply_model_cox_BNT162b2_2_covidadmitted
    - apply_model_cox_BNT162b2_2_coviddeath
    - apply_model_cox_BNT162b2_2_noncoviddeath
    - apply_model_cox_BNT162b2_2_death
    - apply_model_cox_BNT162b2_3_postest
    - apply_model_cox_BNT162b2_3_covidadmitted
    - apply_model_cox_BNT162b2_3_coviddeath
    - apply_model_cox_BNT162b2_3_noncoviddeath
    - apply_model_cox_BNT162b2_3_death
    - apply_model_cox_BNT162b2_4_postest
    - apply_model_cox_BNT162b2_4_covidadmitted
    - apply_model_cox_BNT162b2_4_coviddeath
    - apply_model_cox_BNT162b2_4_noncoviddeath
    - apply_model_cox_BNT162b2_4_death
    - apply_model_cox_BNT162b2_5_postest
    - apply_model_cox_BNT162b2_5_covidadmitted
    - apply_model_cox_BNT162b2_5_coviddeath
    - apply_model_cox_BNT162b2_5_noncoviddeath
    - apply_model_cox_BNT162b2_5_death
    outputs:
      moderately_sensitive:
        plot: output/models_cox/images/plot_res_BNT162b2_*.png

  ## plot ChAdOx 

  plot_model_cox_ChAdOx:
    run: r:latest analysis/comparisons/plot_cox.R ChAdOx
    needs:
    - design
    - data_2nd_vax_dates
    - apply_model_cox_ChAdOx_1_postest
    - apply_model_cox_ChAdOx_1_covidadmitted
    - apply_model_cox_ChAdOx_1_coviddeath
    - apply_model_cox_ChAdOx_1_noncoviddeath
    - apply_model_cox_ChAdOx_1_death
    - apply_model_cox_ChAdOx_3_postest
    - apply_model_cox_ChAdOx_3_covidadmitted
    - apply_model_cox_ChAdOx_3_coviddeath
    - apply_model_cox_ChAdOx_3_noncoviddeath
    - apply_model_cox_ChAdOx_3_death
    - apply_model_cox_ChAdOx_4_postest
    - apply_model_cox_ChAdOx_4_covidadmitted
    - apply_model_cox_ChAdOx_4_coviddeath
    - apply_model_cox_ChAdOx_4_noncoviddeath
    - apply_model_cox_ChAdOx_4_death
    - apply_model_cox_ChAdOx_5_postest
    - apply_model_cox_ChAdOx_5_covidadmitted
    - apply_model_cox_ChAdOx_5_coviddeath
    - apply_model_cox_ChAdOx_5_noncoviddeath
    - apply_model_cox_ChAdOx_5_death
    outputs:
      moderately_sensitive:
        plot: output/models_cox/images/plot_res_ChAdOx_*.png

  ## plot BNT162b2andChAdOx 

  plot_model_cox_BNT162b2andChAdOx:
    run: r:latest analysis/comparisons/plot_cox.R BNT162b2andChAdOx
    needs:
    - design
    - data_2nd_vax_dates
    - apply_model_cox_BNT162b2_1_postest
    - apply_model_cox_BNT162b2_1_covidadmitted
    - apply_model_cox_BNT162b2_1_coviddeath
    - apply_model_cox_BNT162b2_1_noncoviddeath
    - apply_model_cox_BNT162b2_1_death
    - apply_model_cox_BNT162b2_3_postest
    - apply_model_cox_BNT162b2_3_covidadmitted
    - apply_model_cox_BNT162b2_3_coviddeath
    - apply_model_cox_BNT162b2_3_noncoviddeath
    - apply_model_cox_BNT162b2_3_death
    - apply_model_cox_BNT162b2_4_postest
    - apply_model_cox_BNT162b2_4_covidadmitted
    - apply_model_cox_BNT162b2_4_coviddeath
    - apply_model_cox_BNT162b2_4_noncoviddeath
    - apply_model_cox_BNT162b2_4_death
    - apply_model_cox_BNT162b2_5_postest
    - apply_model_cox_BNT162b2_5_covidadmitted
    - apply_model_cox_BNT162b2_5_coviddeath
    - apply_model_cox_BNT162b2_5_noncoviddeath
    - apply_model_cox_BNT162b2_5_death
    - apply_model_cox_ChAdOx_1_postest
    - apply_model_cox_ChAdOx_1_covidadmitted
    - apply_model_cox_ChAdOx_1_coviddeath
    - apply_model_cox_ChAdOx_1_noncoviddeath
    - apply_model_cox_ChAdOx_1_death
    - apply_model_cox_ChAdOx_3_postest
    - apply_model_cox_ChAdOx_3_covidadmitted
    - apply_model_cox_ChAdOx_3_coviddeath
    - apply_model_cox_ChAdOx_3_noncoviddeath
    - apply_model_cox_ChAdOx_3_death
    - apply_model_cox_ChAdOx_4_postest
    - apply_model_cox_ChAdOx_4_covidadmitted
    - apply_model_cox_ChAdOx_4_coviddeath
    - apply_model_cox_ChAdOx_4_noncoviddeath
    - apply_model_cox_ChAdOx_4_death
    - apply_model_cox_ChAdOx_5_postest
    - apply_model_cox_ChAdOx_5_covidadmitted
    - apply_model_cox_ChAdOx_5_coviddeath
    - apply_model_cox_ChAdOx_5_noncoviddeath
    - apply_model_cox_ChAdOx_5_death
    outputs:
      moderately_sensitive:
        plot: output/models_cox/images/plot_res_BNT162b2andChAdOx_*.png

  ## plot BNT162b2vsChAdOx 

  plot_model_cox_BNT162b2vsChAdOx:
    run: r:latest analysis/comparisons/plot_cox.R BNT162b2vsChAdOx
    needs:
    - design
    - data_2nd_vax_dates
    - apply_model_cox_both_1_postest
    - apply_model_cox_both_1_covidadmitted
    - apply_model_cox_both_1_coviddeath
    - apply_model_cox_both_1_noncoviddeath
    - apply_model_cox_both_1_death
    - apply_model_cox_both_3_postest
    - apply_model_cox_both_3_covidadmitted
    - apply_model_cox_both_3_coviddeath
    - apply_model_cox_both_3_noncoviddeath
    - apply_model_cox_both_3_death
    - apply_model_cox_both_4_postest
    - apply_model_cox_both_4_covidadmitted
    - apply_model_cox_both_4_coviddeath
    - apply_model_cox_both_4_noncoviddeath
    - apply_model_cox_both_4_death
    - apply_model_cox_both_5_postest
    - apply_model_cox_both_5_covidadmitted
    - apply_model_cox_both_5_coviddeath
    - apply_model_cox_both_5_noncoviddeath
    - apply_model_cox_both_5_death
    outputs:
      moderately_sensitive:
        plot: output/models_cox/images/plot_res_BNT162b2vsChAdOx_*.png

